---
import { getCollection } from 'astro:content';
// Component Imports
import CallToAction from '../components/CallToAction.astro';
// Page section components
import ContactCTA from '../components/ContactCTA.astro';
import Grid from '../components/Grid.astro';
import Hero from '../components/Hero.astro';
import Icon from '../components/Icon.astro';
import Pill from '../components/Pill.astro';
import PortfolioPreview from '../components/PortfolioPreview.astro';
import Skills from '../components/Skills.astro';
import BlogPreview from '../components/BlogPreview.astro';
// Layout import — provides basic page elements: <head>, <nav>, <footer> etc.
import BaseLayout from '../layouts/BaseLayout.astro';
import { Image } from 'astro:assets';
import heroWoman from '../assets/osaango-hero-woman2.jpg';
import apiopsCyclesWS from '../assets/service-images/AccelerateAPIOpsCycles.jpg';
import AgileGames from '../assets/service-images/Osaango_Agile_Games.jpg';


// Content Fetching: List four most recent work projects
const projects = (await getCollection('work'))
        .sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf())
        .slice(0, 4);

const posts = (await getCollection('blog'))
        .sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf())
        .slice(0, 3);

// Full Astro Component Syntax:
// https://docs.astro.build/basics/astro-components/
---

<BaseLayout>
	<div class="stack gap-20 lg:gap-48">
		<div class="wrapper stack gap-8 lg:gap-20">
			<header class="hero">
				<Hero
					title="Scale with confidence"
					tagline="We partner with you to align strategy, APIs, and delivery"
					align="start"
				>
<!-- 					<div class="roles">
						<Pill><Icon icon="code" size="1.33em" /> Consulting APIs and Agile</Pill>
						<Pill><Icon icon="microphone-stage" size="1.33em" /> Speaking</Pill>
						<Pill><Icon icon="pencil-line" size="1.33em" /> Guidelines and Marketing messages</Pill>
					</div> -->
				</Hero>

                                <Image
                                        src={heroWoman}
                                        alt="a woman looking at a scalable ecosystem"
                                        width={480}
                                        height={620}
                                        sizes="(max-width: 50em) 75vw, 480px"
                                        widths={[260, 360, 480, 600]}
                                        format="webp"
					loading="eager"
                                        fetchpriority="high"
                                />
			</header>

			<Skills />
                </div>

                <main class="wrapper stack gap-20 lg:gap-48">
                                        <section class="intro">
                                                <div class="promo-content">
                                                        <div class="text stack gap-4">
                                                                <header class="section-header stack gap-2 lg:gap-4">
                                                                        <h3>Accelerate Your APIs with APIOps Cycles Workshop</h3>
                                                                        <p class="">Your first practical step toward scalable, business-aligned APIs. A compact, high-impact <strong>2-hour online or onsite workshop</strong> </p>
                                                                </header>
                                                                <div class="cta">
                                                                        <CallToAction href="/services/accelerate-your-apis-with-apiops-cycles/">
                                                                                View Details
                                                                                <Icon icon="arrow-right" size="1.2em" />
                                                                        </CallToAction>
                                                                </div>
                                                        </div>
                                                        <div class="promo-image">
                                                                <Image
                                                                        src={apiopsCyclesWS}
                                                                        alt="business people looking at the APIOps Cycles metro map"
                                                                        width={1200}
                                                                        height={675}
                                                                        widths={[280, 360, 480, 600, 660]}
                                                                        sizes="(max-width: 50em) 70vw, 660px"
                                                                        format="webp"
                                                                        loading="eager"
                                                                        fetchpriority="high"
                                                                        class="service-image"
                                                                />
                                                        </div>
                                                </div>
                                        </section>

                                        <section class="intro">
                                                <div class="promo-content promo-content--games">
                                                        <div class="promo-image stack gap-2 lg:gap-4">
                                                                <Image
                                                                                src={AgileGames}
                                                                                alt="Osaango Agile Sprint Challenge and Retro Card games"
                                                                                width={1200}
                                                                                height={630}
                                                                                widths={[280, 360, 480, 600, 660]}
                                                                                sizes="(max-width: 50em) 70vw, 660px"
                                                                                format="webp"
                                                                                loading="eager"
                                                                                fetchpriority="high"
                                                                                class="service-image"
                                                                        />
                                                        </div>                                                        
                                                        <div class="text stack gap-4">
                                                                <header class="section-header stack gap-2 lg:gap-4">
                                                                        <h3>Agile Collaboration Games</h3>
                                                                        <p class="">Two ready-to-play games that energize retros, workshops, and agile coaching — tested with Agile Coaches, Scrum Masters, and Product Owners.</p>
                                                                        <div class="games-list">
                                                                                <p><strong>Agile Sprint Challenge Game</strong></p>
                                                                                <p><strong>Agile Retro Card Game</strong></p>
                                                                                <p>Available from our webshop - view more details.</p>
                                                                        </div>
                                                                </header>

                                                                <div class="cta">
                                                                        <CallToAction href="/services/agile-collaboration-games/">
                                                                                Discover the games
                                                                                <Icon icon="arrow-right" size="1.2em" />
                                                                        </CallToAction>
                                                                </div>
                                                        </div>
                                                </div>
                                        </section>

                        <section class="section with-background with-cta">
                                <header class="section-header stack gap-2 lg:gap-4">
                                        <h3>Selected Work</h3>
                                        <p>Take a look below at some of our featured work for clients from the past few years.</p>
                                </header>

				<div class="gallery">
					<Grid variant="offset">
						{
							projects.map((project) => (
								<li>
									<PortfolioPreview project={project} />
								</li>
							))
						}
					</Grid>
				</div>

				<div class="cta">
					<CallToAction href="/work/">
						View All
						<Icon icon="arrow-right" size="1.2em" />
					</CallToAction>
				</div>
			</section>



                        <section class="section with-background with-cta">
                                <header class="section-header stack gap-2 lg:gap-4">
                                        <h3>Latest Articles</h3>
                                        <p>Read our most recent blog posts.</p>
                                </header>

                                <div class="gallery">
                                        <Grid variant="small">
                                                {posts.map((post) => (
                                                        <li>
                                                                <BlogPreview post={post} />
                                                        </li>
                                                ))}
                                        </Grid>
                                </div>

                                <div class="cta">
                                        <CallToAction href="/blog/">
                                                View All
                                                <Icon icon="arrow-right" size="1.2em" />
                                        </CallToAction>
                                </div>
                        </section>
                </main>

                <ContactCTA />
        </div>
</BaseLayout>

<style>
	.hero {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 2rem;
	}

	.roles {
		display: none;
	}

	.hero img {
		object-fit: cover;
		object-position: left center;
		border-radius: 1.5rem;
		/* box-shadow: var(--shadow-md); */
	}

	@media (min-width: 50em) {
		.hero {
			display: grid;
			grid-template-columns: 6fr 4fr;
			padding-inline: 2.5rem;
			gap: 3.75rem;
		}

		.roles {
			margin-top: 0.5rem;
			display: flex;
			gap: 0.5rem;
		}

		.hero img {
			aspect-ratio: 3/4;
			border-radius: 4.5rem;
			object-fit: cover;
		}
	}

	/* ====================================================== */

	.section {
		display: grid;
		gap: 2rem;
	}

	.with-background {
		position: relative;
	}

	.with-background::before {
		--hero-bg: var(--bg-image-subtle-2);

		content: '';
		position: absolute;
		pointer-events: none;
		left: 50%;
		width: 100vw;
		aspect-ratio: calc(2.25 / var(--bg-scale));
		top: 0;
		transform: translateY(-75%) translateX(-50%);
		background:
			url('/assets/backgrounds/noise.png') top center/220px repeat,
			var(--hero-bg) center center / var(--bg-gradient-size) no-repeat,
			var(--gray-999);
		background-blend-mode: overlay, normal, normal, normal;
		mix-blend-mode: var(--bg-blend-mode);
		z-index: -1;
	}

	.with-background.bg-variant::before {
		--hero-bg: var(--bg-image-subtle-1);
	}

	.section-header {
		justify-self: center;
		text-align: center;
		max-width: 50ch;
		font-size: var(--text-md);
		color: var(--gray-300);
	}

        .section-header h3 {
                font-size: var(--text-2xl);
        }


  .service {
    display: flex;
    flex-direction: column;
    gap: 4rem;
  }

  .intro {
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }

  .tagline {
    font-size: var(--text-lg);
    color: var(--gray-300);
  }

  .promo-content {
    display: grid;
    grid-template-columns: 1fr;
    grid-template-areas:
      'image'
      'text';
    gap: 2rem;
    align-items: center;
  }

  .promo-content .text {
    grid-area: text;
  }

  .promo-content .promo-image {
    grid-area: image;
  }

  .service-image {
    width: 100%;
    aspect-ratio: 16 / 9;
    background: radial-gradient(circle at 20% 20%, var(--gray-700), var(--gray-900)), var(--gradient-subtle);
    border-radius: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--gray-400);
    border: 1px solid var(--gray-700);
    box-shadow: var(--shadow-lg);
    gap: 0.75rem;
    padding: 0rem 0rem 0rem 0rem;
    text-align: left;
  }

  .service-image img {
    width: 100%;
    height: auto;
    border-radius: 1rem;
    object-fit: cover;
  }

  .pitch {
    font-size: var(--text-md);
  }

  .promo-content--games {
    align-items: stretch;
  }

  .badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border-radius: 999px;
    background: var(--gray-0);
    color: var(--gray-900);
    font-weight: 700;
    text-transform: uppercase;
    font-size: var(--text-xs);
    letter-spacing: 0.05em;
  }

  .games-list {
    display: grid;
    gap: 0.35rem;
    font-size: var(--text-md);
    color: var(--gray-0);
  }

  .games-list p {
    margin: 0;
  }

        @media (min-width: 50em) {
                .promo-content {
                        grid-template-columns: 1fr 1fr;
                        grid-template-areas: 'text image';
                }

                .promo-content--games {
                        grid-template-areas: 'image text';
                }

                .section {
                        grid-template-columns: repeat(4, 1fr);
                        grid-template-areas: 'header header header header' 'gallery gallery gallery gallery';
			gap: 5rem;
		}

		.section.with-cta {
			grid-template-areas: 'header header header cta' 'gallery gallery gallery gallery';
		}

		.section-header {
			grid-area: header;
			font-size: var(--text-lg);
		}

		.section-header h3 {
			font-size: var(--text-4xl);
		}

		.with-cta .section-header {
			justify-self: flex-start;
			text-align: left;
		}

		.gallery {
			grid-area: gallery;
		}

		.cta {
			grid-area: cta;
		}
	}

	/* ====================================================== */

	.mention-card {
		display: flex;
		height: 7rem;
		justify-content: center;
		align-items: center;
		text-align: center;
		border: 1px solid var(--gray-800);
		border-radius: 1.5rem;
		color: var(--gray-300);
		background: var(--gradient-subtle);
		box-shadow: var(--shadow-sm);
	}

	@media (min-width: 50em) {
		.mention-card {
			border-radius: 1.5rem;
			height: 9.5rem;
		}
	}
</style>
